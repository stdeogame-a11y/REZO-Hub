 -- REZO HUB - Skill System
local SkillSystem = {}
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local RezoHub = nil

function SkillSystem:Initialize(config)
    self.Config = config
    RezoHub = _G.RezoHub or require(script.Parent.MainScript)
    self.Active = false
    self.CurrentEnemies = {}
    
    print("âœ… Skill System inicializado")
end

function SkillSystem:Update()
    if not self.Config.AutoTrainSkills or not self.Active then
        return
    end
    
    self:ScanForEnemies()
    self:AttackNearestEnemy()
end

function SkillSystem:ScanForEnemies()
    self.CurrentEnemies = {}
    
    local enemyContainers = {
        workspace:FindFirstChild("Enemies"),
        workspace:FindFirstChild("NPCs"),
        workspace:FindFirstChild("Monsters")
    }
    
    for _, container in ipairs(enemyContainers) do
        if container then
            for _, enemy in ipairs(container:GetChildren()) do
                if enemy:FindFirstChild("Humanoid") and enemy:FindFirstChild("HumanoidRootPart") then
                    table.insert(self.CurrentEnemies, enemy)
                end
            end
        end
    end
end

function SkillSystem:AttackNearestEnemy()
    local character = player.Character
    if not character then return end
    
    local humanoid = character:FindFirstChild("Humanoid")
    local rootPart = character:FindFirstChild("HumanoidRootPart")
    if not humanoid or not rootPart then return end
    
    local nearestEnemy = nil
    local shortestDistance = self.Config.EnemyRange
    
    for _, enemy in ipairs(self.CurrentEnemies) do
        local distance = (enemy.HumanoidRootPart.Position - rootPart.Position).Magnitude
        if distance < shortestDistance then
            shortestDistance = distance
            nearestEnemy = enemy
        end
    end
    
    if nearestEnemy then
        humanoid:MoveTo(nearestEnemy.HumanoidRootPart.Position)
        
        if self.Config.DebugMode then
            print("âš¡ Atacando enemigo: " .. nearestEnemy.Name)
        end
    end
end

function SkillSystem:StartTraining()
    self.Active = true
    print("ðŸŽ¯ Auto Entrenamiento ACTIVADO")
end

function SkillSystem:StopTraining()
    self.Active = false
    print("ðŸŽ¯ Auto Entrenamiento DESACTIVADO")
end

function SkillSystem:GetEnemyCount()
    return #self.CurrentEnemies
end

return SkillSystem
